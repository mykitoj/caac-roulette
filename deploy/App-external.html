<!DOCTYPE html>
<html>
<head>
    <title>CAAC-Roulette</title>

    <script type="text/javascript" src="https://rally1.rallydev.com/apps/2.1/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
<<<<<<< HEAD
                Ext.define("CustomApp",{extend:"Rally.app.App",componentCls:"app",launch:function(){this._myMask=new Ext.LoadMask(Ext.getBody(),{msg:"Loading... Please wait."}),this._myMask.show();var filters=[];filters.push(Ext.create("Rally.data.wsapi.Filter",{property:"Deleted",operator:"=",value:"false"})),filters.push(Ext.create("Rally.data.wsapi.Filter",{property:"Disabled",operator:"=",value:"false"}));var activeDate=new Date;activeDate.setDate(activeDate.getDate()-30),filters.push(Ext.create("Rally.data.wsapi.Filter",{property:"LastActiveDate",operator:">=",value:activeDate}));var store=Ext.create("Rally.data.wsapi.Store",{model:"User",fetch:["DefaultProject","DisplayName","EmailAddress","FirstName","Language","LastActiveDate","LastName","MiddleName","OfficeLocation","Phone","Role"],sorters:[{property:"LastActiveDate",direction:"DESC"}],context:this.getContext().getDataContext(),pageSize:200,limit:200},this);store.addFilter(filters,!1),store.loadPage(1,{scope:this,callback:function(records,operation){operation.wasSuccessful()?(this._myMask.hide(),this.displayUser(records,null)):(this._myMask.hide(),this.clearContent(),this.addLabel(this,"Error loading users<br/>"),this.addLabel(this,operation.error.errors[0]))}})},displayUser:function(records,priorUser){this.clearContent();var user;do user=records[Math.floor(Math.random()*records.length)].data;while(null!==priorUser&&user.ObjectID===priorUser.ObjectID);this._myMask=new Ext.LoadMask(Ext.getBody(),{msg:"Loading... Please wait."}),this._myMask.show();var filters=[];filters.push(Ext.create("Rally.data.wsapi.Filter",{property:"Owner.ObjectID",operator:"=",value:user.ObjectID}));var store=Ext.create("Rally.data.wsapi.Store",{model:"UserStory",fetch:["FormattedID","Name"],sorters:[{property:"LastUpdateDate",direction:"DESC"}],context:this.getContext().getDataContext(),pageSize:3,limit:3},this);store.addFilter(filters,!1),store.loadPage(1,{scope:this,callback:function(workItemRecords,operation){if(operation.wasSuccessful()){this._myMask.hide();var fullBox=this.add({xype:"container",border:0,layout:{type:"vbox",align:"stretch"}}),detailsBox=fullBox.add({xype:"container",border:0,flex:1,layout:{type:"hbox",align:"stretch"}}),leftSide=detailsBox.add({xype:"container",border:0,flex:1,layout:{type:"vbox",align:"stretch"}}),color="#"+(user.ObjectID%1e6).toString().padStart(6,"0"),userName=_.compact([user.FirstName,user.MiddleName,user.LastName]).join(" ");this.addLabel(leftSide,userName),user.DisplayName&&user.DisplayName!==userName&&this.addLabel(leftSide,"aka: "+user.DisplayName),user.Role&&"None"!==user.Role&&(this.addHeader(leftSide,"Role",color),this.addLabel(leftSide,user.Role)),user.OfficeLocation&&"None"!==user.OfficeLocation&&(this.addHeader(leftSide,"Office Location",color),this.addLabel(leftSide,user.OfficeLocation)),user.EmailAddress&&(this.addHeader(leftSide,"Email",color),this.addLabel(leftSide,'<a href="mailto:'+user.EmailAddress+'">'+user.EmailAddress+"</a>")),user.Phone&&(this.addHeader(leftSide,"Phone",color),this.addLabel(leftSide,'<a href="tel:'+user.Phone+'">'+user.Phone+"</a>")),user.Language&&(this.addHeader(leftSide,"Language",color),this.addLabel(leftSide,user.Language)),user.DefaultProject&&user.DefaultProject._refObjectName&&(this.addHeader(leftSide,"Default Project",color),this.addLabel(leftSide,user.DefaultProject._refObjectName)),user.LastActiveDate&&(this.addHeader(leftSide,"Last Active Date",color),this.addLabel(leftSide,user.LastActiveDate.toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})));var rightSide=detailsBox.add({xype:"container",border:0,flex:1,layout:{type:"vbox"}});this.addButton(rightSide,"» Next User",color,function(){this.displayUser(records,user.ObjectID)}),this.addLabel(rightSide,"<br/>"),rightSide.add({xtype:"image",src:"http://rally1.rallydev.com/slm/profile/image/"+user.ObjectID+"/100.sp",height:"100px",width:"100px"});var workBox=fullBox.add({xype:"container",border:0,flex:1,layout:{type:"vbox",align:"stretch"}});workItemRecords.length>0&&(this.addHeader(workBox,"Recent Stories",color),_.each(workItemRecords,function(workItemRecord){var workItemBox=workBox.add({xype:"container",border:0,flex:1,layout:{type:"hbox",align:"stretch"},padding:"5 0 0 0"}),workItemLink=Rally.nav.DetailLink.getLink({record:workItemRecord,text:workItemRecord.data.FormattedID});workItemLink=workItemLink.slice(0,3)+'target="_blank"'+workItemLink.slice(3),this.addLabel(workItemBox,workItemLink),this.addLabel(workItemBox,"&nbsp;&nbsp;&nbsp;&nbsp;"),this.addLabel(workItemBox,workItemRecord.data.Name)},this))}else this._myMask.hide(),this.clearContent(),this.addLabel(this,"Error loading users<br/>"),this.addLabel(this,operation.error.errors[0])}})},addHeader:function(parent,text,color){parent.add({xtype:"label",html:"<u><b>"+text+"</b></u>",style:{"font-size":"13px",color:color?color:"#333333"},padding:"5 0 1 0"})},addLabel:function(parent,text){parent.add({xtype:"label",html:text,style:{"font-size":"15px"}})},addButton:function(parent,text,color,handler){var button=parent.add({xtype:"rallybutton",text:text,handler:handler,scope:this,style:{"background-color":color,"border-color":color}});button.getEl().down(".x-btn-inner").setStyle({color:"#FFFFFF","font-size":"15px"})},clearContent:function(){for(;this.down("*");)this.down("*").destroy()}});
=======
                Ext.define("CustomApp",{extend:"Rally.app.App",componentCls:"app",launch:function(){this._myMask=new Ext.LoadMask(Ext.getBody(),{msg:"Loading... Please wait."}),this._myMask.show();var e=[];e.push(Ext.create("Rally.data.wsapi.Filter",{property:"Deleted",operator:"=",value:"false"})),e.push(Ext.create("Rally.data.wsapi.Filter",{property:"Disabled",operator:"=",value:"false"}));var t=new Date;t.setDate(t.getDate()-30),e.push(Ext.create("Rally.data.wsapi.Filter",{property:"LastActiveDate",operator:">=",value:t}));var a=Ext.create("Rally.data.wsapi.Store",{model:"User",fetch:["DefaultProject","DisplayName","EmailAddress","FirstName","Language","LastActiveDate","LastName","MiddleName","OfficeLocation","Phone","Role"],sorters:[{property:"LastActiveDate",direction:"DESC"}],context:this.getContext().getDataContext(),pageSize:200,limit:200},this);a.addFilter(e,!1),a.loadPage(1,{scope:this,callback:function(e,t){t.wasSuccessful()?(this._myMask.hide(),this.displayUser(e,null)):(this._myMask.hide(),this.clearContent(),this.addLabel(this,"Error loading users<br/>"),this.addLabel(this,t.error.errors[0]))}})},displayUser:function(e,t){var a;this.clearContent();do{a=e[Math.floor(Math.random()*e.length)].data}while(null!==t&&a.ObjectID===t.ObjectID);this._myMask=new Ext.LoadMask(Ext.getBody(),{msg:"Loading... Please wait."}),this._myMask.show();var r=new Date;r.setDate(r.getDate()-90),Ext.create("Rally.data.lookback.SnapshotStore",{fetch:["FormattedID","Name"],context:this.getContext().getDataContext(),includeTotalResultCount:!1,removeUnauthorizedSnapshots:!0,compress:!0,pageSize:10,limit:10,filters:[{property:"_TypeHierarchy",operator:"=",value:"HierarchicalRequirement"},{property:"Owner",operator:"=",value:a.ObjectID},{property:"ScheduleState",operator:">",value:"Defined"},{property:"_ValidFrom",operator:">=",value:r}],sorters:[{property:"_ValidFrom",direction:"DESC"}]}).load({scope:this,callback:function(t,r){if(r.wasSuccessful()){this._myMask.hide();var o=this.add({xype:"container",border:0,layout:{type:"vbox",align:"stretch"}}),i=o.add({xype:"container",border:0,flex:1,layout:{type:"hbox",align:"stretch"}}),d=i.add({xype:"container",border:0,flex:1,layout:{type:"vbox",align:"stretch"}}),s="#"+(a.ObjectID%1e6).toString().padStart(6,"0"),l=_.compact([a.FirstName,a.MiddleName,a.LastName]).join(" ");this.addLabel(d,l),a.DisplayName&&a.DisplayName!==l&&this.addLabel(d,"aka: "+a.DisplayName),a.Role&&"None"!==a.Role&&(this.addHeader(d,"Role",s),this.addLabel(d,a.Role)),a.OfficeLocation&&"None"!==a.OfficeLocation&&(this.addHeader(d,"Office Location",s),this.addLabel(d,a.OfficeLocation)),a.EmailAddress&&(this.addHeader(d,"Email",s),this.addLabel(d,'<a href="mailto:'+a.EmailAddress+'">'+a.EmailAddress+"</a>")),a.Phone&&(this.addHeader(d,"Phone",s),this.addLabel(d,'<a href="tel:'+a.Phone+'">'+a.Phone+"</a>")),a.Language&&(this.addHeader(d,"Language",s),this.addLabel(d,a.Language)),a.DefaultProject&&a.DefaultProject._refObjectName&&(this.addHeader(d,"Default Project",s),this.addLabel(d,a.DefaultProject._refObjectName)),a.LastActiveDate&&(this.addHeader(d,"Last Active Date",s),this.addLabel(d,a.LastActiveDate.toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})));var n=i.add({xype:"container",border:0,flex:1,layout:{type:"vbox"}});this.addButton(n,"» Next User",s,function(){this.displayUser(e,a.ObjectID)}),this.addLabel(n,"<br/>"),n.add({xtype:"image",src:"http://rally1.rallydev.com/slm/profile/image/"+a.ObjectID+"/100.sp",height:"100px",width:"100px"});var c=o.add({xype:"container",border:0,flex:1,layout:{type:"vbox",align:"stretch"}});if(t.length>0){this.addHeader(c,"Recent Stories",s);var h=[];_.each(t,function(e){if(!h.includes(e.data.FormattedID)){var t=c.add({xype:"container",border:0,flex:1,layout:{type:"hbox",align:"stretch"},padding:"5 0 0 0"});this.addButton(t,e.data.FormattedID,s,function(){Rally.nav.Manager.showDetail(e.raw._ref)}),this.addLabel(t,e.data.Name),h.push(e.data.FormattedID)}},this)}}else this._myMask.hide(),this.clearContent(),this.addLabel(this,"Error loading users<br/>"),this.addLabel(this,r.error.errors[0])}})},addHeader:function(e,t,a){e.add({xtype:"label",html:"<u><b>"+t+"</b></u>",style:{"font-size":"13px",color:a||"#333333"},padding:"5 0 1 0"})},addLabel:function(e,t){e.add({xtype:"label",html:t,style:{"font-size":"15px"}})},addButton:function(e,t,a,r){e.add({xtype:"rallybutton",text:t,handler:r,scope:this,style:{"background-color":a,"border-color":a}}).getEl().down(".x-btn-inner").setStyle({color:"#FFFFFF","font-size":"15px"})},clearContent:function(){for(;this.down("*");)this.down("*").destroy()}});
>>>>>>> db28d76df20206c29489327352040ec71cfb3e79

            Rally.launchApp('CustomApp', {
                name:"CAAC-Roulette",
	            parentRepos:""
            });

        });
    </script>


    <style type="text/css">
        
    </style>
</head>
<body>
</body>
</html>
